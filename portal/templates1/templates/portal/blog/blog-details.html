{% extends "portal/base.html" %}

{% load static %}

{% block custom_css %}
<style>
    /* Ensure the blog content looks nice */
    .blog-content-formatted h2, 
    .blog-content-formatted h3 {
        margin-top: 30px;
        margin-bottom: 15px;
        font-weight: 700;
        color: #1a1a1a;
    }
    .blog-content-formatted p {
        margin-bottom: 20px;
        line-height: 1.8;
    }
    .blog-content-formatted ul, 
    .blog-content-formatted ol {
        margin-left: 20px;
        margin-bottom: 20px;
    }
    .blog-content-formatted blockquote {
        border-left: 4px solid #DF0A0A; /* Your theme color */
        padding-left: 20px;
        font-style: italic;
        color: #555;
    }
</style>
{% endblock custom_css %}

{% block content %}

<div class="rts-breadcrumb-area one" 
style="background-image: url('{% if banner %}{{ banner.background_image.url }}{% else %}{% static 'assets/images/breadcrumb/01.webp' %}{% endif %}');">
    <div class="container h-100">
       <div class="breadcrumb-area-wrapper">
           <div class="nav-bread-crumb">
               <a href="{% url 'home' %}">Home</a>
               <span><i class="fa-regular fa-chevron-right"></i></span>
               <a href="#" class="current">Blog</a>
           </div>
           <h1 class="title">
               {% if banner %}{{ banner.title }}{% else %}Our Blog{% endif %}
           </h1>
       </div>
    </div>
</div>

<section class="rts-blog-area inner rts-section-gap">
    <div class="container">
        <div class="section-inner">
            <div class="row g-5">
                
                <div class="col-lg-8">
                    <div class="blog-details-area">
                        <div class="image top-image radius-10 overflow-hidden mb--40">
                            <img class="w-100" src="{{ post.image.url }}" alt="{{ post.title }}">
                        </div>
                        <h2 class="mb--30">{{ post.title }}</h2>
                        <div class="mb--30 blog-content-formatted">
                            {{ post.content|safe }}
                        </div>
                        
                        <div class="comment-area mb--40">
                            <h2>{{ comments.count }} Comments</h2>
                            {% for comment in comments %}
                            <div class="comment-box mb--30">
                                <div class="author">
                                    <div class="image"><img src="{% static 'portal/assets/images/testimonials/author-01.svg' %}" alt="user"></div>
                                    <div class="content">
                                        <h6>{{ comment.name }}</h6>
                                        <p>{{ comment.created_at|timesince }} ago</p>
                                    </div>
                                </div>
                                <p>{{ comment.message }}</p>
                            </div>
                            {% empty %}
                            <p class="text-muted">No comments yet. Be the first!</p>
                            {% endfor %}
                            
                            <div class="comment-form">
                                <h2 class="mb--30">Leave a Comment</h2>
                                <form method="POST" action="{% url 'blog_details' post.slug %}">
                                    {% csrf_token %}
                                    
                                    <div class="row">
                                        <div class="col-lg-12 mb-3">
                                            <input type="text" name="name" class="form-control" placeholder="Your Name" required 
                                                   style="background: #f5f5f5; border: none; padding: 15px; border-radius: 5px; width: 100%;">
                                        </div>
                                    </div>
                            
                                    <textarea name="message" placeholder="Write your comment here..." required></textarea>
                                    
                                    <button type="submit" class="rts-btn radius-small btn-primary mt-3">Submit Comment</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 pl--30 pl_md--15 pl_sm--15">
                    <div class="rts-sidebar">
                        
                        <div class="rts-single-sidebar recent-post">
                            <h5 class="title">Recent Posts</h5>
                            <div class="recent-post-area">
                                
                                {% for recent in recent_posts %}
                                <div class="recent-post-single d-flex align-items-center mb-4">
                                    <div class="thumbnail me-3">
                                        <a href="{% url 'blog_details' recent.slug %}">
                                            <img src="{{ recent.image.url }}" alt="Blog" 
                                                 style="width: 90px; height: 90px; object-fit: cover; border-radius: 5px;">
                                        </a>
                                    </div>
                                    
                                    <div class="content-area">
                                        <div class="user text-muted mb-1" style="font-size: 13px;">
                                            <i class="fa-regular fa-clock me-1"></i>
                                            <span>{{ recent.date|date:"d M, Y" }}</span>
                                        </div>
                                        <a class="post-title" href="{% url 'blog_details' recent.slug %}">
                                            <h6 class="title fw-bold" style="font-size: 16px; line-height: 1.4; margin: 0;">
                                                {{ recent.title }}
                                            </h6>
                                        </a>
                                    </div>
                                </div>
                                {% endfor %}

                            </div>
                        </div>
                        </div>
                </div>
                </div> </div>
    </div>
</section>

{% endblock content %}

{% block custom_js %}
{% endblock custom_js %}