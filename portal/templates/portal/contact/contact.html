{% extends "portal/base.html" %}

{% load static %}

{% block custom_css %}


{% endblock custom_css %}

{% block content %}


    <!-- breadcrumb area start -->
    <!-- rts breadcrumb area start -->
    <div class="rts-breadcrumb-area one" 
         style="background-image: url('{% if banner and banner.background_image %}{{ banner.background_image.url }}{% else %}{% static 'portal/assets/images/breadcrumb/08.webp' %}{% endif %}');">
        <div class="container h-100">
            <div class="breadcrumb-area-wrapper">
                <div class="nav-bread-crumb">
                    <a href="{% url 'home' %}">Home</a> <span><i class="fa-regular fa-chevron-right"></i></span>
                    <a href="#" class="current">{{ banner.title|default:"Contact Us" }}</a>
                </div>
                <h1 class="title">{{ banner.title|default:"Contact Us" }}</h1>
            </div>
        </div>
    </div>
    <!-- rts breadcrumb area end -->
    <!-- breadcrumb area end -->

    <!-- rts contact area start -->
    <section class="rts-contact-area inner rts-section-gap">
        <div class="container">
            <div class="section-inner body-bg-one radius-10">
                
                <form class="contact-form" id="custom-contact-form">
                    {% csrf_token %} 
                    
                    <h4 class="title">Your info</h4>
                    <div class="form-inner">
                        <div class="left">
                            <div class="single-input-wrapper">
                                <label for="name">Full Name*</label>
                                <input type="text" id="name" name="name" placeholder="Enter your full name" required>
                            </div>
                            <div class="single-input-wrapper">
                                <label for="email">Email*</label>
                                <input type="email" id="email" name="email" placeholder="Your email address" required>
                            </div>
                            <div class="single-input-wrapper">
                                <label for="phone">Number (Optional)</label>
                                <input type="text" id="phone" name="phone" placeholder="Your Number">
                            </div>
                        </div>
                        <div class="right">
                            <div class="single-input-wrapper">
                                <label for="message">Your Enquiry*</label>
                                <textarea name="message" id="message" placeholder="Enter your message here" required></textarea>
                            </div>
                            <div class="single-input-wrapper">
                                <button type="submit" id="submitBtn" class="rts-btn btn-primary with-arrow">
                                    Get Started <i class="fa-regular fa-arrow-up up-right"></i>
                                </button>
                            </div>
                            
                            <div id="form-messages" class="mt-15 cb"></div>
                            
                            <p class="desc">Please read our <a href="#"> privacy policy</a> and <a href="#">Cookies policy</a> so you understand how we collect and use your personal data.</p>
                        </div>
                    </div>
                </form>
            </div>
    
            <div class="contact-form-content-bottom-wrapper mt--30">
                <div class="row g-5">
                    
                    {% for card in cards %}
                    <div class="col-lg-4">
                        <div class="single-contact-card body-bg-one radius-10">
                            <div class="top-area">
                                <div class="icon">
                                    {% if card.icon %}
                                        <img src="{{ card.icon.url }}" alt="{{ card.title }}">
                                    {% endif %}
                                </div>
                                <h4 class="title">{{ card.title }}</h4>
                            </div>
                            
                            <p class="disc">
                                {{ card.description }}
                            </p>
            
                            {% if card.contact_info %}
                                <a href="#">{{ card.contact_info }}</a>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
            
                </div>
            </div>


        </div>
    </section>
    <!-- rts contact area end -->

    <!-- rts map area start -->
    <div class="rts-map-area">
        <div class="container">
            <div class="contact-map-area-fluid">
                {% if google_map %}
                    {{ google_map.map_embed_code|safe }}
                {% else %}
                    <p class="text-center p-5">Map loading...</p>
                {% endif %}
            </div>
        </div>
    </div>
    <!-- rts map area end -->

    <!-- rts faq area start -->
    {% comment %} {% if faq_settings %}
    <section class="rts-faq-area kayaking rts-section-gapTop">
        <div class="container">
            <div class="section-inner">
                <div class="row g-5">
                    
                    <div class="col-lg-4">
                        <div class="image-area overflow-hidden radius-10 wow zoomIn" data-wow-delay="0.4s">
                            {% if faq_settings.side_image %}
                                <img class="wow scaleIn" data-wow-delay="0.4s" src="{{ faq_settings.side_image.url }}" alt="FAQ Image">
                            {% endif %}
                        </div>
                    </div>
    
                    <div class="col-lg-8">
                        <div class="faq-content">
                            <div class="section-title-area">
                                <h2 class="section-title mb-0">{{ faq_settings.title }}</h2>
                            </div>
    
                            <div class="accordion-faq-one mt--60">
                                <div class="accordion" id="accordionExample">
                                    
                                    {% for item in faq_items %}
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button {% if not forloop.first %}collapsed{% endif %}" type="button" 
                                                    data-bs-toggle="collapse" 
                                                    data-bs-target="#collapse{{ forloop.counter }}" 
                                                    aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}" 
                                                    aria-controls="collapse{{ forloop.counter }}">
                                                {{ item.question }}
                                            </button>
                                        </h2>
                                        
                                        <div id="collapse{{ forloop.counter }}" 
                                             class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" 
                                             data-bs-parent="#accordionExample">
                                            <div class="accordion-body">
                                                {{ item.answer }}
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
    
                                </div>
                            </div>
                        </div>
                    </div>
    
                </div>
            </div>
        </div>
    </section>
    {% endif %} {% endcomment %}
    <!-- rts faq area end -->

    {% endblock content %}

    {% block custom_js %}
    <script>
        // UPDATED ID HERE: "custom-contact-form"
        document.getElementById('custom-contact-form').addEventListener('submit', function(e) {
            e.preventDefault(); 
            e.stopImmediatePropagation(); // Extra safety to stop other scripts
    
            const btn = document.getElementById('submitBtn');
            const msgDiv = document.getElementById('form-messages');
            const originalText = btn.innerHTML;
            const formData = new FormData(this);
    
            // 1. Loading State
            btn.innerHTML = 'Sending...';
            btn.disabled = true;
            msgDiv.innerHTML = ''; 
    
            // 2. Send Data
            fetch("", { 
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(response => response.json())
            .then(data => {
                // 3. Reset Button
                btn.innerHTML = originalText;
                btn.disabled = false;
    
                // 4. Show Message
                if (data.status === 'success') {
                    msgDiv.innerHTML = `<span style="color: green; font-weight: bold;">${data.message}</span>`;
                    document.getElementById('custom-contact-form').reset();
                } else {
                    msgDiv.innerHTML = `<span style="color: red; font-weight: bold;">${data.message}</span>`;
                }
            })
            .catch(error => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                msgDiv.innerHTML = `<span style="color: red; font-weight: bold;">Something went wrong. Try again.</span>`;
            });
        });
    </script>
    {% endblock custom_js %}