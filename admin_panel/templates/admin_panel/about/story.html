{% extends 'admin_panel/base.html' %}
{% load static %}

{% block custom_css %}
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<style>
    .ql-container {
        font-family: 'Inter', sans-serif;
        font-size: 1rem;
        background-color: #fff;
    }
    /* Make the editor tall so you can write Vision/Mission comfortably */
    .ql-editor { min-height: 400px; } 
</style>
{% endblock custom_css %}

{% block content %}
<div class="container-fluid p-4">
    <div class="row">
        <div class="col-lg-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom p-4">
                    <h3>About Us Manager</h3>
                    <p class="text-muted mb-0">Single editor mode: Write Overview, Vision, and Mission all in one place.</p>
                </div>
                
                <div class="card-body p-4">
                    <form method="POST" enctype="multipart/form-data" id="about-form">
                        {% csrf_token %}
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold">Main Title</label>
                            {{ form.title }}
                        </div>

                        <div class="mb-4">
                            <label class="form-label fw-bold">Page Content</label>
                            <div id="editor-container">
                                {{ form.description.value|default_if_none:""|safe }}
                            </div>
                            <input type="hidden" name="description" id="hidden-description">
                        </div>

                        <div class="row align-items-center bg-light p-3 rounded mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Side Image</label>
                                {{ form.story_image }}
                            </div>
                            <div class="col-md-6 text-center">
                                {% if story.story_image %}
                                    <img src="{{ story.story_image.url }}" class="rounded shadow-sm" style="max-height: 120px;">
                                {% endif %}
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="form-check form-switch">
                                {{ form.is_active }}
                                <label class="form-check-label ms-2">Show this section?</label>
                            </div>
                        </div>

                        <div class="text-end">
                            <button class="btn btn-primary btn-lg px-5" type="submit">Save Content</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}

{% block scriptcontent %}
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var quill = new Quill('#editor-container', {
            theme: 'snow',
            modules: {
                toolbar: [
                    [{ 'header': [2, 3, 4, false] }], // Use H2/H3 for "Vision"/"Mission"
                    ['bold', 'italic', 'underline'],
                    [{ 'color': [] }],
                    [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                    [{ 'align': [] }],
                    ['clean']
                ]
            },
            placeholder: 'Type your Overview, then add headings for Vision, Mission, etc...'
        });

        var form = document.getElementById('about-form');
        form.onsubmit = function() {
            document.getElementById('hidden-description').value = quill.root.innerHTML;
        };
    });
</script>
{% endblock %}